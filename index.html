<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roblox Particle Style Brightening</title>
<style>
  body { font-family: Arial, sans-serif; background:#222; color:white; text-align:center; }
  canvas { border:1px solid #555; margin-top:20px; display:block; margin-left:auto; margin-right:auto; }
  input, button { margin-top:20px; padding:8px; font-size:16px; }
</style>
</head>
<body>

<h2>Upload an image to convert like Roblox particles</h2>
<input type="file" id="upload" accept="image/*"><br>
<canvas id="canvas"></canvas><br>
<button id="download">Download PNG</button>

<script>
const upload = document.getElementById('upload');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const downloadBtn = document.getElementById('download');
let processed = false;

upload.addEventListener('change', e => {
  const file = e.target.files[0];
  const img = new Image();

  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img,0,0);

    const imgData = ctx.getImageData(0,0,canvas.width,canvas.height);
    const data = imgData.data;

    for (let i = 0; i < data.length; i += 4) {
      let r = data[i];
      let g = data[i+1];
      let b = data[i+2];
      let a = data[i+3];

      // Find the max channel (red, green, or blue)
      let maxChannel = Math.max(r, g, b);

      if (maxChannel === 0) {
        // pixel is pure black, make transparent
        data[i+3] = 0;
      } else {
        // scale each channel to preserve hue but remove black
        data[i]   = Math.round(r / maxChannel * 255);
        data[i+1] = Math.round(g / maxChannel * 255);
        data[i+2] = Math.round(b / maxChannel * 255);
        // alpha stays the same
      }
    }

    ctx.putImageData(imgData,0,0);
    processed = true;
  };

  img.src = URL.createObjectURL(file);
});

// Download button
downloadBtn.onclick = () => {
  if (!processed) return alert("Upload and process an image first.");
  const link = document.createElement("a");
  link.download = "roblox-particle.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
};
</script>

</body>
</html>
